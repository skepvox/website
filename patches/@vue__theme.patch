diff --git a/src/vitepress/support/utils.ts b/src/vitepress/support/utils.ts
index b991a0e1c9008c6b3a92de37e2eb11d630e1dd13..55ae29c3847886ca591cf0cf89d6e67b99057483 100644
--- a/src/vitepress/support/utils.ts
+++ b/src/vitepress/support/utils.ts
@@ -1,4 +1,4 @@
-import { withBase } from 'vitepress'
+import { useData, withBase } from 'vitepress'
 import { ref } from 'vue'
 
 export const hashRE = /#.*$/
@@ -14,15 +14,16 @@ export function ensureStartingSlash(path: string): string {
 }
 
 export function normalizeLink(url: string): string {
-  if (isExternal(url)) {
+  if (isExternal(url) || url.startsWith('#')) {
     return url
   }
+  const { site } = useData()
   const { pathname, search, hash } = new URL(url, 'http://vuejs.org')
-  return withBase(
-    pathname.endsWith('/') || pathname.endsWith('.html')
-      ? url
-      : `${pathname.replace(/(\.md)?$/, '.html')}${search}${hash}`
-  )
+  if (pathname.endsWith('/') || pathname.endsWith('.html')) {
+    return withBase(url)
+  }
+  const suffix = site.value.cleanUrls ? '' : '.html'
+  return withBase(`${pathname.replace(/(\.md)?$/, suffix)}${search}${hash}`)
 }
 
 const inBrowser = typeof window !== 'undefined'
